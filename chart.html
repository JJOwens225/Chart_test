<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Valeur Actuelle</title>
  </head>
  <body>
    <div class="valeur_actuelle">Chargement...</div>

    <script>
      const sheetId = "1z_WrDvVdBD6Krz1KOpW0xcHhxP5GG4DlAWPtzJCxXxg";
      const apiKey = "AIzaSyDIn6YFlyrxc_6q2MDBRuzxudY9bi56-ds";
      const range = "Indice Token!C2"; // Valeur actuelle du token "Ivoire"

      async function getValeurActuelle() {
        try {
          const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
          const response = await fetch(url);
          const data = await response.json();

          const valeur = data.values[0][0];
          document.querySelector(".valeur_actuelle").textContent = valeur;
        } catch (error) {
          console.error("Erreur de récupération :", error);
          document.querySelector(".valeur_actuelle").textContent = "Erreur";
        }
      }

      // Lancer au chargement
      getValeurActuelle();

      // Actualiser toutes les 60 secondes (60000 ms)
      setInterval(getValeurActuelle, 60000);
    </script>
  </body>
</html>
